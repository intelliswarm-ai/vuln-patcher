package ai.intelliswarm.vulnpatcher.sources;

import ai.intelliswarm.vulnpatcher.models.Vulnerability;
import io.smallrye.mutiny.Uni;

import java.util.List;
import java.util.concurrent.CompletableFuture;

public interface VulnerabilitySource {
    
    /**
     * Fetch vulnerabilities from this source
     */
    default Uni<List<Vulnerability>> fetchVulnerabilities() {
        return Uni.createFrom().completionStage(fetchVulnerabilitiesAsync());
    }
    
    /**
     * Async fetch vulnerabilities (for backward compatibility)
     */
    default CompletableFuture<List<Vulnerability>> fetchVulnerabilitiesAsync() {
        return fetchVulnerabilities().subscribeAsCompletionStage();
    }
    
    /**
     * Check if this source is enabled
     */
    boolean isEnabled();
    
    /**
     * Get the name of this vulnerability source
     */
    String getSourceName();
}